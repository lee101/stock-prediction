[pytest]
testpaths =
    tests
norecursedirs = .* build dist CVS _darcs {arch} *.egg static models templates kuber data results
addopts = --import-mode=importlib
asyncio_mode = auto
asyncio_default_fixture_loop_scope = function
pythonpath = .
markers =
    # Test categorization markers
    unit: marks fast unit tests that don't require external services or heavy models (run by default in CI)
    integration: marks integration-level simulations that may use models or external services
    slow: marks slow-running tests (typically >10s, skipped in fast CI runs)
    model_required: marks tests that require loading ML models (e.g., Chronos, NeuralForecast)

    # Resource requirement markers
    cuda_required: marks tests that require CUDA-enabled PyTorch (skipped on CPU-only runners)
    gpu_required: marks tests that require any GPU (CUDA or other)
    cpu_only: marks tests that can only run on CPU (for testing CPU fallback paths)
    memory_intensive: marks tests requiring significant RAM (>8GB)

    # External dependency markers
    external: marks tests that hit external services and are skipped in CI unless opted-in
    requires_openai: marks tests that need live OpenAI API access
    requires_alpaca: marks tests that need Alpaca API access
    requires_binance: marks tests that need Binance API access
    network_required: marks tests that require internet connectivity

    # Special test types
    auto_generated: marks auto-generated coverage tests (off by default)
    experimental: marks tests that live under tests/experimental and are skipped unless --run-experimental is provided
    asyncio: marks asynchronous tests that rely on pytest-asyncio
    benchmark: marks performance benchmark tests
    smoke: marks minimal smoke tests for quick validation

    # CI-specific markers
    ci_skip: marks tests to skip in all CI environments
    self_hosted_only: marks tests that require self-hosted runner features (GPU, specific hardware)
